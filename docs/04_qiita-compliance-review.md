# Qiita利用規約遵守レビュー

## レビュー日
2025-12-05（仕様書作成時点）

## 確認した規約事項

### 1. データ取得方法 ✅
**規約**: スクレイピングは禁止、APIの利用は推奨
**現状**: Qiita API v2を使用してデータを取得
**判定**: ✅ **問題なし** - 公式APIを使用しているため問題なし

### 2. 記事本文の保存・表示 ✅
**規約**: 記事の全文を無断で転載することは避け、タイトルや概要、リンクなどを表示する形での利用が適切
**現状（修正後）**: 
- 記事本文はEmbedding生成にのみ使用（一時的な処理）
- 記事本文自体は保存しない（ベクトル化された数値のみ保存）
- 検索結果には記事本文を表示しない
**判定**: ✅ **問題なし** - 一時的な処理に使用し、保存・表示しないため問題なし

**採用方針**:
- 記事本文を取得してEmbedding生成に使用
- Embedding生成後は記事本文を破棄
- ベクトル（数値配列）のみをVectorizeに保存
- 検索結果にはタイトル、URL、タグ、著者、投稿日時のみ表示

### 3. 収益化の制限 ✅
**規約**: Qiitaのデータを元にしたサービスに広告を設置して収益化する行為は禁止
**現状**: 
- 仕様書に収益化の記載なし
- 「ネタアプリ」として非商用を想定
**判定**: ✅ **問題なし** - ただし、明示的に非商用であることを記載すべき

### 4. 商用利用の制限 ✅
**規約**: 商用目的で運営される場合、Qiitaのデータを利用することが規約違反となる可能性
**現状**: 
- 「ネタアプリ」として非商用を想定
- 個人開発プロジェクト
**判定**: ✅ **問題なし** - ただし、明示的に非商用であることを記載すべき

### 5. レート制限の遵守 ✅
**規約**: APIのレート制限を遵守する必要がある
**現状**: 
- 1時間あたり60リクエスト（認証なし）を遵守
- リクエスト間に適切な間隔を設ける
**判定**: ✅ **問題なし** - レート制限を遵守している

### 6. 著作権の尊重 ✅
**規約**: 記事の著作権は投稿者に帰属
**現状**: 
- 記事のタイトル、URL、タグ、著者、投稿日時、いいね数のみを表示
- 記事本文はEmbedding生成にのみ一時的に使用し、保存・表示しない
- 記事へのリンクを提供
**判定**: ✅ **問題なし** - 記事本文を保存・表示せず、ベクトル化のみに使用するため問題なし

### 7. 出典の表示 ✅
**規約**: （明示的な記載はないが、一般的に推奨される）
**現状**: 
- 検索結果に記事のURLを表示
- 記事へのリンクを提供
**判定**: ✅ **問題なし** - 記事へのリンクを提供しているため、出典は明確

## 実装済みの対応事項

### 1. 記事本文の保存・表示方法 ✅
**実装済み**:
- 記事本文はEmbedding生成にのみ一時的に使用
- Embedding生成後は記事本文を即座に破棄
- ベクトル（数値配列）のみをVectorizeに保存
- 検索結果にはタイトル、URL、タグ、著者、投稿日時、いいね数のみ表示
- 記事本文の要約や本文の一部は一切表示しない

### 2. 非商用の明示 ✅
**実装済み**:
- 要件定義書に「非商用プロジェクト」として明記
- 制約事項に「商用利用は行わない」ことを記載
- アーキテクチャ仕様書に「非商用プロジェクト: 広告や収益化は行わない」と記載

### 3. 出典表示の強化 ✅
**実装済み**:
- 検索結果に「出典: Qiita」の表示を追加（ArticleCardコンポーネント）
- 各記事カードに「Qiitaで読む」リンクを明確に表示

## 実装仕様（確定版）

### データモデル
```typescript
interface VectorizeArticle {
  id: string;                    // 記事ID（Qiita記事ID）
  values: number[];              // Embeddingベクトル（768次元）
  // 記事本文はEmbedding生成にのみ使用し、保存しない（Qiita利用規約遵守のため）
  metadata: {
    title: string;               // 記事タイトル
    url: string;                 // 記事URL
    // body: 保存しない（Embedding生成にのみ一時的に使用）
    tags: string[];              // タグ（文字列配列）
    createdAt: string;           // 投稿日時（ISO 8601）
    author: string;              // 投稿者ID
    likesCount: number;          // いいね数
  };
}
```

### Embedding生成処理
```typescript
// タイトル + タグ + 本文でEmbedding生成（本文は一時的にのみ使用）
const tagsText = article.tags.map(t => t.name).join(' ');
const embedding = await env.AI.run('@cf/baai/bge-base-en-v1.5', {
  text: `${article.title}\n${tagsText}\n${article.body}`
});
// 記事本文はここで破棄され、ベクトルのみが保存される

// Vectorizeに保存（ベクトルのみ、記事本文は含まない）
await env.VECTORIZE_INDEX.insert([{
  id: article.id,
  values: embedding.data[0],
  metadata: {
    title: article.title,
    url: article.url,
    tags: article.tags.map(t => t.name),
    createdAt: article.created_at,
    author: article.user.id,
    likesCount: article.likes_count
  }
}]);
```

### 検索結果表示
- タイトル、URL、タグ、著者、投稿日時、いいね数のみ表示
- 記事本文の要約は一切表示しない
- 「出典: Qiita」を表示
- 「Qiitaで読む」リンクを明確に表示

## 結論

### 最終判定
- ✅ **すべて問題なし**: すべての規約事項を遵守している

### 実装済みの対応
1. ✅ **記事本文の扱い**: Embedding生成にのみ一時的に使用し、保存・表示は一切行わない
2. ✅ **非商用の明示**: 要件定義書、アーキテクチャ仕様書に明記
3. ✅ **出典表示**: 検索結果に「出典: Qiita」を表示し、「Qiitaで読む」リンクを提供

### 遵守状況
- ✅ データ取得方法: 公式APIを使用
- ✅ 記事本文の保存・表示: 保存・表示しない（ベクトル化のみに使用）
- ✅ 収益化: 非商用プロジェクトとして運営
- ✅ 商用利用: 非商用プロジェクトとして運営
- ✅ レート制限: 1時間あたり60リクエストを遵守
- ✅ 著作権: 記事本文を保存・表示しないため問題なし
- ✅ 出典表示: 明確に表示

**結論**: 現在の実装は、Qiitaの利用規約を完全に遵守している。

